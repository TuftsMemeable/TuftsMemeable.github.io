<html>

  <head>
    <script src="createOrder.js"></script>    
    <link rel="stylesheet" href="style.css">
    
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    
  </head>

  <body>
      
    <script language="javascript">

    
        $(document).ready(function(){
          $('body').css({ display: 'none'}).fadeIn(1500);
        });
        

    
    // * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

    //Validates that required fields are filled in before submitting the form
    function validation() {
    	
    	with (document.buyerform) {
    		//validate first name
    		if (fname.value == "") {
    			alert("Please enter your first name");
                fname.focus();
    			return false;
    		}
    		
            //validate last name
            if (lname.value == "") {
                alert("Please enter your last name");
                lname.focus();
    			return false;
            }
            
            // verify email is a tufts.edu address and not empty
            email_address = email.value;
            console.log("email address: " + email_address);

            if (email.value == "" || !/tufts.edu\s*$/.test(email_address)) {
                alert("Please enter a valid \"@tufts.edu\" email address");
                email.focus();
                return false;
            }
                
            //validate phone field is not empty and is in the right format
    		var phone_pattern = /^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/;
    
    		if (!phone.value.match(phone_pattern) || phone.value == "") {
    			alert("Please enter a valid phone number using the dash format: 123-456-7890")
    			phone.focus();
    			return false;
    		}
            
            // checkbox validation
            if(!consent.checked) {
                
                alert("Please check the box to indicate you commit to submitting payment upon receiving your swag. Thank you!");
                
                $('#consent-div').css(
                    {
                        "border-color": "#4A0D66", "border-width":"2px", "border-style":"solid"
                    });
                
                return false;
            }
    		
    		return true;
    	}
    }
    
    // * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

    //Determines the day when the order will be ready for pickup
    // window.onload = function() {
        
        // //get current date
        // d = new Date;
        // 
        // var months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
        // 
        // var days = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"];
        // 
        // day_month = "Your order " + 
        //             "will be ready for pickup this coming " + 
        //             days[(d.getDay() + 4) % 7] + "!";
        //             // ", " + 
        //             // months[d.getMonth()];
        // 
        // //add delivery date to page
        // $('#delivery_date').html(day_month);
                
        // testStuff();
        // getParams();
        
    // }
    
    // * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
    
    function getParams() {
        console.log('inside get params');
        
        var params = decodeOrderData(window.location.search);
        var color = params["color"];
        var orderType = params["orderType"];
        var size = params["size"];
        var quantity = params["quantity"];
        var memeImage = params["memeImage"];
        
        calculateOrder(orderType, quantity, price, size, color);
        
    }
    
    // * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

    //Calculate order cost and populate order summary form
    function calculateOrder(orderType, quantity, price, size, color) {
        console.log('inside calculateOrder');
        
        //add the params data to order summary fields
        $("#count").val(quantity);
        
        $("#size").val(size);
        
        $("#item").val(orderType);
        
        // $("#price").val(price);// don't have this yet in params
        $("#price").val("$" + 25); // placeholder
        
        // subtotal = quantity * price;
        subtotal = quantity * 25; //placeholder value for now
        $("#subtotal").val("$" + subtotal);
        
        tax = subtotal * 0.0625;
        $("#tax").val("$" + tax.toFixed(2));
        
        total = tax + subtotal;
        $("#total").val("$" + total.toFixed(2));
        
        //disable the fields
        $(".summary").prop("disabled", true);
        
    }
    
    // * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

    function testStuff() {
        var queryParams = createOrder("shirt", "white", "small", 42, "randomImage.png");
        if (queryParams != undefined) {
          window.location.href = "placeorder.html?" + queryParams
        }
    }
    
    // * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
    
    </script>
    
    <!-- HERO IMAGE -->
    <div id="hero-placeorder">
        <p>Please review your order and fill out the form to get your swag in just 4 days! <br> 
        </p>
    </div>


    <!-- ORDER SUMMARY -->
    <div id="order-summary">
        <h2>Your Order Summary</h2>
        
        <form name="orderform">
            
            <label for="item">Product:</label>
            <input class="summary" type="text"  name='item' id="item" />
            
            <br>
            
            <label for="size">Size:</label>
            <input class="summary" type="text"  name='size' id="size" />
            
            <br>
            
            <label for="count">Count:</label>
            <input class="summary" type="text"  name='count' id="count" />
            
            <br>
            
            <label for="price">Item Price:</label>
            <input class="summary" type="text"  name='price' id="price"/>
            
            <br>
            
            <label for="subtotal">Subtotal:</label>
            <input class="summary" type="text"  name='subtotal' id="subtotal" />
            
            <br>
            
            <label for="tax">MA tax 6.25%:</label> 
            <input class="summary" type="text"  name='tax' id="tax"/>
            
            <br>
            
            <label for="total">Total:</label> 
            <input class="summary" type="text"  name='total' id="total"/>
            
            <br>
            
            <a class="button" id="" href="design.html">&larr; Update Order</a>
        </form>
    </div>
    
        
    <!-- CUSTOMER INFORMATION -->
    <form name="buyerform" onsubmit="return validation()" action="ordercomplete.html">
        
        <div id="customer-info">
            <h2>Your Information</h2>
            
            <label for="fname">First Name*:</label>
            <input class="info" type="text"  name='fname' value="sam"/>
            
            <br>
            
            <label for="lname">Last Name*:</label>
            <input class="info" type="text"  name='lname' value="Ewenczyk"/>
            
            <br>
        
            <label for="email">Email*:</label>
            <input class="info" type="email"   name='email' value='sam@tufts.edu' placeholder="john.dewick@tufts.edu" title="Please enter a valid email address"/>
            
            <br>        
            
            <label for="phone">Phone*:</label>
            <input class="info" type="tel"   name='phone' value="123-456-7890"  placeholder="format: 123-456-7890" title="Please enter a valid phone number using this pattern: 123-456-7890"/>
            
            <div id="consent-div">
                <input id="consent" type="checkbox" name="consent"> 
                <label for="consent">By checking this box you commit to paying TuftsMemable at time of pickup.</label>
            </div>
            
            
            <div class="center">
                <input class="button" type = "submit" value = "Confirm Order"/>
            </div>
        </div>
        
        <!-- <div id="delivery_date">
        </div> -->
    
        
    

        
    </form>
<div class="" style="background-color: black">
    <a class="button" id="" href="index.html">Home Page for testing</a>
    <button onclick="testStuff()">Generate Parameters</button>
    <button onclick="getParams()">Fill Order Summary</button>
</div>
    
    
  </body>

</html>

